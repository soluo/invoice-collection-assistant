# 2.3 D√©tail Facture ‚≠ê NOUVEAU

**Fichier** : `src/pages/InvoiceDetail.tsx` (‚úÖ cr√©√©)
**Maquette** : `specs/V2/mockups/facture_detail.html`
**Statut** : üü¢ Termin√©

---

## T√¢ches

### 2.3.1 Cr√©er route `/invoices/:id`
- [x] Ajouter dans `App.tsx`

### 2.3.2 Layout 2 colonnes
- [x] Colonne gauche (35%) : D√©tails facture
- [x] Colonne droite (65%) : Historique de l'activit√©
- [x] Responsive : empil√©es sur mobile

### 2.3.3 En-t√™te facture (header)
- [x] Rappel "Facture #numFacture"
- [x] Nom du client en dessous
- [x] Badge √©tat √† droite : A envoyer / En retard (nb de jours) / Pay√©e / En attente
- [x] Sous le badge √©tat √† droite : Un badge correspondant au statut de relance en cours de la facture (ex: Relance 1)

### 2.3.4 D√©tails facture (colonne gauche)
- [x] Badge statut dynamique (large)
- [x] Infos : Solde d√ª si diff√©rent du Montant TTC sinon Montant TTC, Date √©ch√©ance (en rouge si en retard), Date d'√©mission, Infos de contact
- [x] Section "Client" : Nom, Email, T√©l√©phone, Responsable

### 2.3.5 Actions rapides (2 boutons - version simplifi√©e)
- [x] "Enregistrer un paiement" ‚Üí Modal gestion des paiements
- [ ] "Loguer une action" ‚Üí Modal textarea (NON IMPL√âMENT√â pour l'instant)
- [ ] "Mettre en pause" ‚Üí Toggle (NON IMPL√âMENT√â pour l'instant)
- [x] "T√©l√©charger PDF" ‚Üí Download

### 2.3.6 Historique d√©taill√© (colonne droite)
- [x] Timeline verticale (composant Timeline)
- [x] Types d'√©v√©nements :
  - Cr√©ation/import (ic√¥ne Upload)
  - Relance auto (ic√¥ne Mail)
  - Email ouvert (ic√¥ne EnvelopeOpen) - Nouveau (NON IMPL√âMENT√â - pas encore de tracking d'ouverture)
  - Action manuelle (ic√¥ne User)
  - Paiement (ic√¥ne Check green)
- [x] Chaque entry : Timestamp + description + auteur

---

## Backend requis

- [x] Query `invoices.getById` (r√©cup√®re une facture avec toutes ses infos calcul√©es)
- [x] Query `events.getByInvoice` (r√©cup√®re l'historique des √©v√©nements pour une facture)
- [x] Table `events` d√©j√† existante (tracking complet des √©v√©nements)
  - Champs : invoiceId, eventType, eventDate, description, metadata, userId, organizationId
  - Types : invoice_imported, invoice_marked_sent, invoice_sent, payment_registered, invoice_marked_paid, reminder_sent
- [ ] Mutation `invoices.logAction` (pour "Loguer une action") - NON IMPL√âMENT√â
- [ ] Mutation `invoices.togglePause` - NON IMPL√âMENT√â
