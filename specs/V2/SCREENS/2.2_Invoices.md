# 2.2 Factures (Liste)

**Fichier** : `src/pages/Invoices.tsx` (refonte)
**Maquette** : `specs/V2/mockups/factures.html`
**Statut** : ✅ Complété

---

## Tâches

### 2.2.1 Refonte filtres avancés ✅
- [x] Recherche : N° facture ou nom client
- [x] Dropdown : Statut (Tous, En retard, Paiement partiel, En attente, Payée, En litige)
- [x] Input : Montant (±5% tolérance)
- [x] Dropdown : Technicien (liste déroulante pour admins)
- [x] **Filtres synchronisés avec URL** (partage/bookmark)

### 2.2.2 Tableau responsive avec nouvelles colonnes ✅
- [x] Colonnes : N° Facture + Client regroupées, Date émission, Montant Total, **Solde Dû** (nouveau), Échéance, Statut, Responsable
- [x] Hover state : bg-gray-50
- [x] Lien "Voir" (détail à implémenter en Phase 2.3)
- [x] **Tri côté serveur** avec icônes cliquables (Émission, Montant TTC, Solde Dû, Échéance)
- [x] **Tri synchronisé avec URL** (défaut: Date émission DESC)

### 2.2.3 Pagination ✅
- [x] shadcn Pagination component avec ellipsis
- [x] Limiter à 20 par page
- [x] Affichage "Page X sur Y (Z factures)"

### 2.2.4 Nouveaux badges de statut ✅
- [x] En retard (red)
- [x] Paiement partiel (orange) - NOUVEAU
- [x] En attente (blue)
- [x] Payée (green)
- [x] En litige (yellow) - NOUVEAU

### 2.2.5 Responsive mobile ✅
- [x] Cards empilées au lieu de table
- [x] Filtres accessibles (formulaire responsive)

---

## Backend requis

- [x] ✅ Ajouter statuts "partial_payment", "pending" et "litigation" au schema invoices
- [x] ✅ Enrichir query `invoices.list` et `invoices.listWithFilter` avec champ `outstandingBalance` (Solde Dû)
- [x] ✅ Implémenter filtres avancés dans `listWithFilter` : recherche texte, statut, montant ±5%, technicien
- [x] ✅ **Tri serveur** : ajout paramètres `sortBy` et `sortOrder` aux queries
