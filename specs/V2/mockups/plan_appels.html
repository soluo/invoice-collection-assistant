<!DOCTYPE html>
<html lang="fr" class="h-full bg-gray-100">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clients à appeler - ZenRelance</title>
    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chargement de Google Font "Inter" -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chargement de Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        /* Définition de la police Inter comme police par défaut */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Style pour la scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Style pour la sidebar active */
        .sidebar-link.active {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
        }

        .sidebar-link.active i {
            color: white;
        }

        /* Style pour la carte client sélectionnée */
        .client-card.selected {
            background-color: #eef2ff; /* indigo-50 */
            border-color: #6366f1; /* indigo-500 */
        }
    </style>
</head>

<body class="h-full flex">

    <!-- Backdrop pour le menu mobile -->
    <div id="menu-backdrop" class="fixed inset-0 bg-black/30 z-30 md:hidden hidden"></div>

    <!-- Sidebar -->
    <aside id="sidebar"
        class="fixed top-0 left-0 w-64 h-full bg-white shadow-lg z-40 transform -translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col">
        <!-- Logo -->
        <div class="flex items-center justify-center h-16 border-b px-4">
            <h1 class="text-2xl font-bold text-indigo-600">ZenRelance</h1>
        </div>
        <!-- Navigation -->
        <nav class="flex-1 overflow-y-auto py-4">
            <ul class="space-y-2 px-4">
                <li>
                    <a href="dashboard_admin.html"
                        class="sidebar-link flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                        <i class="ph-bold ph-house text-xl text-gray-500"></i>
                        <span>Tableau de bord</span>
                    </a>
                </li>
                <li>
                    <a href="rapprochement.html"
                        class="sidebar-link flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                        <i class="ph-bold ph-arrows-counter-clockwise text-xl text-gray-500"></i>
                        <span>Rapprochement</span>
                    </a>
                </li>
                <li>
                    <a href="factures.html"
                        class="sidebar-link flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                        <i class="ph-bold ph-files text-xl text-gray-500"></i>
                        <span>Factures</span>
                    </a>
                </li>
                 <li>
                    <a href="import_facture.html"
                        class="sidebar-link flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                        <i class="ph-bold ph-upload-simple text-xl text-gray-500"></i>
                        <span>Importer</span>
                    </a>
                </li>
                <li>
                    <a href="clients.html"
                        class="sidebar-link flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                        <i class="ph-bold ph-users text-xl text-gray-500"></i>
                        <span>Clients</span>
                    </a>
                </li>
                <li>
                    <a href="plan_appels.html"
                        class="sidebar-link active flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                        <i class="ph-bold ph-phone-call text-xl text-gray-500"></i>
                        <span>Clients à appeler</span>
                    </a>
                </li>
                <li>
                    <a href="agenda.html"
                        class="sidebar-link flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                        <i class="ph-bold ph-calendar-blank text-xl text-gray-500"></i>
                        <span>Agenda</span>
                    </a>
                </li>
            </ul>
        </nav>
        <!-- User / Settings -->
        <div class="border-t p-4">
            <a href="reglages.html"
                class="sidebar-link flex items-center gap-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors">
                <i class="ph-bold ph-gear text-xl text-gray-500"></i>
                <span>Réglages</span>
            </a>
        </div>
    </aside>

    <!-- Main content -->
    <div class="flex-1 md:ml-64 flex flex-col h-screen overflow-hidden">

        <!-- Top bar -->
        <header class="flex-shrink-0 flex items-center justify-between h-16 px-6 bg-white border-b md:justify-end">
            <!-- Mobile menu button -->
            <button id="menu-button" class="md:hidden text-gray-600 focus:outline-none">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                </svg>
            </button>
            <!-- User menu -->
            <div class="flex items-center">
                <span class="text-sm font-medium mr-4 text-gray-700">Bonjour, Alexandre</span>
                <div class="w-10 h-10 rounded-full bg-indigo-200 text-indigo-700 flex items-center justify-center font-bold">
                    A
                </div>
            </div>
        </header>

        <!-- Page content -->
        <main class="flex-1 flex overflow-hidden">

            <!-- Colonne de gauche : File d'attente -->
            <div class="w-full lg:w-1/3 xl:w-1/4 flex-shrink-0 bg-gray-50 border-r border-gray-200 overflow-y-auto">
                <div class="p-4 border-b border-gray-200">
                    <h1 class="text-2xl font-bold text-gray-900">Clients à appeler (3)</h1>
                    <p class="text-sm text-gray-600">Factures où l'automatisme est terminé.</p>
                </div>

                <div id="client-list" class="p-4 space-y-3">
                    <!-- Carte Client 1 (Sélectionnée) -->
                    <div id="client-1" class="client-card p-4 rounded-xl border-2 border-indigo-500 bg-indigo-50 shadow-sm cursor-pointer" data-client-id="1">
                        <div class="flex justify-between items-center mb-1">
                            <p class="font-semibold text-gray-900">Mme. Valérie Petit</p>
                            <span class="text-lg font-bold text-red-600">450 €</span>
                        </div>
                        <p class="text-sm text-gray-600">Facture F2024-072</p>
                        <span class="mt-2 inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800">
                            3 relances (auto)
                        </span>
                    </div>

                    <!-- Carte Client 2 -->
                    <div id="client-2" class="client-card p-4 rounded-xl border border-gray-200 bg-white shadow-sm cursor-pointer hover:bg-gray-50" data-client-id="2">
                        <div class="flex justify-between items-center mb-1">
                            <p class="font-semibold text-gray-900">Agence Immo Sud</p>
                            <span class="text-lg font-bold text-red-600">1 200 €</span>
                        </div>
                        <p class="text-sm text-gray-600">Facture F2024-065</p>
                        <span class="mt-2 inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800">
                            3 relances (auto)
                        </span>
                    </div>

                    <!-- Carte Client 3 -->
                    <div id="client-3" class="client-card p-4 rounded-xl border border-gray-200 bg-white shadow-sm cursor-pointer hover:bg-gray-50" data-client-id="3">
                        <div class="flex justify-between items-center mb-1">
                            <p class="font-semibold text-gray-900">M. Gérard Martin</p>
                            <span class="text-lg font-bold text-red-600">800 €</span>
                        </div>
                        <p class="text-sm text-gray-600">Facture F2024-080</p>
                        <span class="mt-2 inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800">
                            3 relances (auto)
                        </span>
                    </div>
                </div>
            </div>

            <!-- Colonne de droite : Cockpit d'appel -->
            <div class="flex-1 flex flex-col overflow-y-auto bg-white">
                <div class="flex-1 p-6 lg:p-8 space-y-6">

                    <!-- En-tête du cockpit -->
                    <div>
                        <h2 id="cockpit-client-name" class="text-3xl font-bold text-gray-900">Mme. Valérie Petit</h2>
                        <p class="text-lg text-gray-600">Dossier: <span id="cockpit-facture-id" class="font-medium">F2024-072</span></p>
                    </div>

                    <!-- Infos Contact -->
                    <div class="rounded-xl border border-gray-200 bg-white shadow-sm">
                        <div class="p-5">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">Informations de contact</h3>
                            <div class="space-y-2">
                                <a id="cockpit-phone" href="tel:0601020304" class="flex items-center gap-3 text-indigo-600 hover:text-indigo-800">
                                    <i class="ph ph-phone-call text-xl"></i>
                                    <span class="font-medium">06 01 02 03 04</span>
                                </a>
                                <a id="cockpit-email" href="mailto:valerie.petit@yahoo.fr" class="flex items-center gap-3 text-indigo-600 hover:text-indigo-800">
                                    <i class="ph ph-envelope text-xl"></i>
                                    <span class="font-medium">valerie.petit@yahoo.fr</span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Historique -->
                    <div class="rounded-xl border border-gray-200 bg-white shadow-sm">
                        <div class="p-5">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Historique des relances</h3>
                            <ul id="cockpit-history" class="space-y-3">
                                <li class="flex items-center gap-3">
                                    <span class="flex h-8 w-8 items-center justify-center rounded-full bg-red-100 text-red-600"><i class="ph-bold ph-device-mobile"></i></span>
                                    <p class="text-sm text-gray-600">SMS "Rappel (J+20)" envoyé le <span class="font-medium text-gray-800">18 Oct. 2025</span></p>
                                </li>
                                <li class="flex items-center gap-3">
                                    <span class="flex h-8 w-8 items-center justify-center rounded-full bg-orange-100 text-orange-600"><i class="ph-bold ph-paper-plane-tilt"></i></span>
                                    <p class="text-sm text-gray-600">Email "Sérieux (J+10)" envoyé le <span class="font-medium text-gray-800">08 Oct. 2025</span></p>
                                </li>
                                <li class="flex items-center gap-3">
                                    <span class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-100 text-blue-600"><i class="ph-bold ph-paper-plane-tilt"></i></span>
                                    <p class="text-sm text-gray-600">Email "Amical (J+1)" envoyé le <span class="font-medium text-gray-800">29 Sept. 2025</span></p>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Script d'appel -->
                    <div class="rounded-xl border-2 border-indigo-200 bg-indigo-50">
                        <div class="p-5">
                            <h3 class="text-lg font-semibold text-indigo-900 mb-3">Script d'appel (suggestion)</h3>
                            <p id="cockpit-script" class="text-indigo-800">
                                "Bonjour Mme. Petit, c'est Alexandre de [Votre Entreprise]. Je vous appelle concernant la facture <span class="font-bold">F2024-072</span> de <span class="font-bold">450 €</span>. Vous avez dû recevoir 3 relances automatiques de notre part. Serait-il possible de régler cela aujourd'hui ?"
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Footer : Loguer l'appel -->
                <div class="sticky bottom-0 bg-gray-50 border-t border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900">Loguer l'appel</h3>
                    <p class="text-sm text-gray-600 mb-4">Que s'est-il passé ?</p>

                    <!-- Boutons d'action -->
                    <div class="grid grid-cols-3 gap-3 mb-4">
                        <button class="action-btn" data-action="no-answer">Pas de réponse</button>
                        <button class="action-btn" data-action="payment-promised">Paiement promis</button>
                        <button class="action-btn" data-action="dispute">En litige</button>
                    </div>

                    <!-- Date de suivi (si "Paiement promis") -->
                    <div id="payment-date-block" class="mb-4 hidden">
                        <label for="payment-date" class="block text-sm font-medium text-gray-700">Date de paiement promise</label>
                        <input type="date" id="payment-date" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                    </div>

                    <!-- Notes -->
                    <div>
                        <label for="call-notes" class="block text-sm font-medium text-gray-700">Notes (interne)</label>
                        <textarea id="call-notes" rows="3" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Ex: M'a dit qu'elle payait vendredi soir..."></textarea>
                    </div>

                    <!-- Bouton Valider -->
                    <button id="validate-call-btn" class="mt-4 w-full rounded-lg bg-indigo-600 px-4 py-3 text-base font-semibold text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50">
                        Valider et passer au suivant
                    </button>
                </div>
            </div>

        </main>
    </div>

    <script>
        // Données des clients (pour la simulation)
        const clientData = {
            "1": {
                name: "Mme. Valérie Petit",
                factureId: "F2024-072",
                amount: "450 €",
                phone: "06 01 02 03 04",
                email: "valerie.petit@yahoo.fr",
                history: [
                    { icon: 'ph-device-mobile', color: 'red', text: 'SMS "Rappel (J+20)" envoyé le', date: '18 Oct. 2025' },
                    { icon: 'ph-paper-plane-tilt', color: 'orange', text: 'Email "Sérieux (J+10)" envoyé le', date: '08 Oct. 2025' },
                    { icon: 'ph-paper-plane-tilt', color: 'blue', text: 'Email "Amical (J+1)" envoyé le', date: '29 Sept. 2025' }
                ],
                script: "Bonjour Mme. Petit, c'est Alexandre de [Votre Entreprise]. Je vous appelle concernant la facture <span class=\"font-bold\">F2024-072</span> de <span class=\"font-bold\">450 €</span>. Vous avez dû recevoir 3 relances automatiques de notre part. Serait-il possible de régler cela aujourd'hui ?"
            },
            "2": {
                name: "Agence Immo Sud",
                factureId: "F2024-065",
                amount: "1 200 €",
                phone: "04 91 00 00 00",
                email: "sophie.dubois@immosud.fr",
                history: [
                    { icon: 'ph-device-mobile', color: 'red', text: 'SMS "Rappel (J+20)" envoyé le', date: '19 Oct. 2025' },
                    { icon: 'ph-paper-plane-tilt', color: 'orange', text: 'Email "Sérieux (J+10)" envoyé le', date: '09 Oct. 2025' },
                    { icon: 'ph-paper-plane-tilt', color: 'blue', text: 'Email "Amical (J+1)" envoyé le', date: '30 Sept. 2025' }
                ],
                script: "Bonjour Sophie, c'est Alexandre de [Votre Entreprise]. Je vous appelle concernant la facture <span class=\"font-bold\">F2024-065</span> de <span class=\"font-bold\">1 200 €</span>. Elle a dépassé l'échéance et les 3 relances auto sont parties. Quand pensez-vous pouvoir la régler ?"
            },
            "3": {
                name: "M. Gérard Martin",
                factureId: "F2024-080",
                amount: "800 €",
                phone: "06 22 33 44 55",
                email: "g.martin22@gmail.com",
                history: [
                    { icon: 'ph-device-mobile', color: 'red', text: 'SMS "Rappel (J+20)" envoyé le', date: '17 Oct. 2025' },
                    { icon: 'ph-paper-plane-tilt', color: 'orange', text: 'Email "Sérieux (J+10)" envoyé le', date: '07 Oct. 2025' },
                    { icon: 'ph-paper-plane-tilt', color: 'blue', text: 'Email "Amical (J+1)" envoyé le', date: '28 Sept. 2025' }
                ],
                script: "Bonjour M. Martin, Alexandre de [Votre Entreprise] à l'appareil. Je fais suite à nos 3 relances auto pour la facture <span class=\"font-bold\">F2024-080</span> de <span class=\"font-bold\">800 €</span>. Y a-t-il un souci avec la facture ou puis-je m'attendre à un règlement bientôt ?"
            }
        };

        // Fonction pour mettre à jour le cockpit
        function updateCockpit(clientId) {
            const data = clientData[clientId];
            if (!data) return;

            // Mettre à jour les infos
            document.getElementById('cockpit-client-name').textContent = data.name;
            document.getElementById('cockpit-facture-id').textContent = data.factureId;

            const phoneLink = document.getElementById('cockpit-phone');
            phoneLink.href = `tel:${data.phone.replace(/\s/g, '')}`;
            phoneLink.querySelector('span').textContent = data.phone;

            const emailLink = document.getElementById('cockpit-email');
            emailLink.href = `mailto:${data.email}`;
            emailLink.querySelector('span').textContent = data.email;

            document.getElementById('cockpit-script').innerHTML = data.script;

            // Mettre à jour l'historique
            const historyList = document.getElementById('cockpit-history');
            historyList.innerHTML = ''; // Vider l'historique

            const iconColors = {
                red: 'bg-red-100 text-red-600',
                orange: 'bg-orange-100 text-orange-600',
                blue: 'bg-blue-100 text-blue-600'
            };

            data.history.forEach(item => {
                const li = document.createElement('li');
                li.className = 'flex items-center gap-3';
                li.innerHTML = `
                    <span class="flex h-8 w-8 items-center justify-center rounded-full ${iconColors[item.color]}">
                        <i class="ph-bold ${item.icon}"></i>
                    </span>
                    <p class="text-sm text-gray-600">${item.text} <span class="font-medium text-gray-800">${item.date}</span></p>
                `;
                historyList.appendChild(li);
            });
        }

        // Fonction pour gérer la sélection d'un client
        function selectClient(clientId) {
             // Mettre à jour la sélection visuelle
            document.querySelectorAll('.client-card').forEach(card => {
                if (card.dataset.clientId === clientId) {
                    card.classList.add('selected', 'border-indigo-500', 'bg-indigo-50');
                    card.classList.remove('border-gray-200', 'bg-white', 'hover:bg-gray-50');
                } else {
                    card.classList.remove('selected', 'border-indigo-500', 'bg-indigo-50');
                    card.classList.add('border-gray-200', 'bg-white', 'hover:bg-gray-50');
                }
            });

            // Mettre à jour le cockpit
            updateCockpit(clientId);
        }

        document.addEventListener('DOMContentLoaded', () => {
            // --- Logique de la Sidebar ---
            const menuButton = document.getElementById('menu-button');
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('menu-backdrop');

            const toggleMenu = () => {
                sidebar.classList.toggle('-translate-x-full');
                backdrop.classList.toggle('hidden');
            };

            if (menuButton) menuButton.addEventListener('click', toggleMenu);
            if (backdrop) backdrop.addEventListener('click', toggleMenu);

            // --- Logique de sélection de client ---
            const clientList = document.getElementById('client-list');
            clientList.addEventListener('click', (e) => {
                const card = e.target.closest('.client-card');
                if (card) {
                    selectClient(card.dataset.clientId);
                }
            });

            // Sélectionner le premier client par défaut
            selectClient('1');


            // --- Logique du formulaire "Loguer l'appel" ---
            const actionButtons = document.querySelectorAll('.action-btn');
            const paymentDateBlock = document.getElementById('payment-date-block');
            const validateButton = document.getElementById('validate-call-btn');

            // Style des boutons d'action
            actionButtons.forEach(button => {
                // Style de base
                button.classList.add('px-4', 'py-3', 'rounded-lg', 'border', 'text-sm', 'font-semibold', 'transition-colors');
                // Style non sélectionné
                button.classList.add('bg-white', 'border-gray-300', 'text-gray-700', 'hover:bg-gray-50');
            });

            const actionBtnSelectedClass = ['bg-indigo-600', 'border-indigo-600', 'text-white'];
            const actionBtnNotSelectedClass = ['bg-white', 'border-gray-300', 'text-gray-700', 'hover:bg-gray-50'];

            actionButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const action = button.dataset.action;

                    // Gérer l'état visuel
                    actionButtons.forEach(btn => {
                        btn.classList.remove(...actionBtnSelectedClass);
                        btn.classList.add(...actionBtnNotSelectedClass);
                    });
                    button.classList.add(...actionBtnSelectedClass);
                    button.classList.remove(...actionBtnNotSelectedClass);

                    // Gérer la logique d'affichage
                    if (action === 'payment-promised') {
                        paymentDateBlock.classList.remove('hidden');
                        validateButton.textContent = 'Programmer le suivi';
                    } else if (action === 'no-answer') {
                        paymentDateBlock.classList.add('hidden');
                        validateButton.textContent = 'Rappeler demain';
                    } else if (action === 'dispute') {
                        paymentDateBlock.classList.add('hidden');
                        validateButton.textContent = 'Marquer en litige';
                    }
                });
            });
        });
    </script>

</body>
</html>

